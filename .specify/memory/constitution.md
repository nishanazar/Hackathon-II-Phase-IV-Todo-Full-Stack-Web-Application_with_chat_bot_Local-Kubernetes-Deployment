<!--
Sync Impact Report:
- Version change: 1.0.0 -> 2.0.0
- Modified principles: All principles updated for Phase II Full-Stack Web App
- Added sections: Core Principles (4), Key Standards, Constraints, Success Criteria
- Removed sections: Old principles from Phase I Console App
- Templates requiring updates: .specify/templates/plan-template.md, .specify/templates/spec-template.md, .specify/templates/tasks-template.md
- Follow-up TODOs: None
-->

# Phase II Constitution (Concise)

## Core Principles

### I. Spec-driven: All work starts and ends with /specs/
All development work must be based on specifications in the /specs/ directory. No implementation should proceed without a corresponding spec. All changes must be traced back to spec files, and implementation must align with the specifications exactly as written. This ensures consistency and traceability throughout the development process.

### II. No manual coding: Only AI agents (Qwen CLI) edit code
All code must be generated by AI agents, specifically using Qwen CLI tools. Manual coding by humans is strictly prohibited. Any code written directly by humans without AI agent assistance is non-compliant with this constitution. This ensures consistency and adherence to project standards across all code changes.

### III. Strict user isolation via JWT + DB filtering
The application must implement strict user isolation using JWT authentication and database-level filtering. Users must only be able to access their own data. The backend must verify JWT tokens and filter database queries by user ID to ensure no cross-user data access occurs. This is critical for security and privacy compliance.

### IV. Stateless JWT auth with shared BETTER_AUTH_SECRET
Authentication must be stateless using JWT tokens with a shared BETTER_AUTH_SECRET environment variable. The secret must be consistent across all services (frontend and backend) to ensure proper token validation. This enables horizontal scaling and simplifies deployment while maintaining security standards.

## Key Standards

The application must adhere to these technology requirements and architectural standards:
- Monorepo structure exactly as defined (.spec-kit/, specs/, frontend/, backend/)
- Tech stack fixed: Next.js 16+ App Router • FastAPI • SQLModel • Neon PostgreSQL • Better Auth + JWT
- All API endpoints: /api/{user_id}/tasks/* with JWT required and user_id matching
- Specs referenced via @specs/... syntax

## Constraints

The following constraints are non-negotiable and must be strictly adhered to:
- No tech stack deviations
- No shared sessions — JWT only
- All features require spec in /specs/features/ before implementation
- Schema/API/UI changes must update respective spec files

## Success Criteria

The project will be considered successful when it meets these criteria:
- Full CRUD web app with responsive UI
- Perfect multi-user isolation (no cross-user data access)
- Complete flow: signup → login → manage own tasks → logout
- JWT verified correctly by backend
- docker-compose up works with persistent storage
- All code traceable to specs via agentic workflow
- Ready for Phase III

## Governance

This constitution supersedes all other development practices. All pull requests and code reviews must verify compliance with these principles. Deviations from this constitution require explicit spec update and approval by project leadership. Amendments to this constitution require explicit documentation and approval following the same spec-driven process as other project changes.

**Version**: 2.0.0 | **Ratified**: 2025-01-01 | **Last Amended**: 2026-01-03